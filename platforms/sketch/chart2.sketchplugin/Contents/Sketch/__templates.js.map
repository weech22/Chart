{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@babel/runtime/helpers/typeof.js","webpack://exports/./node_modules/@skpm/promise/index.js","webpack://exports/./node_modules/events/events.js","webpack://exports/./node_modules/mocha-js-delegate/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/browser-api.js","webpack://exports/./node_modules/sketch-module-web-view/lib/constants.js","webpack://exports/./node_modules/sketch-module-web-view/lib/dispatch-first-click.js","webpack://exports/./node_modules/sketch-module-web-view/lib/execute-javascript.js","webpack://exports/./node_modules/sketch-module-web-view/lib/fitSubview.js","webpack://exports/./node_modules/sketch-module-web-view/lib/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/inject-client-messaging.js","webpack://exports/./node_modules/sketch-module-web-view/lib/movable-area.js","webpack://exports/./node_modules/sketch-module-web-view/lib/parseWebArguments.js","webpack://exports/./node_modules/sketch-module-web-view/lib/set-delegates.js","webpack://exports/./node_modules/sketch-module-web-view/lib/webview-api.js","webpack://exports/./node_modules/sketch-module-web-view/remote.js","webpack://exports/./platforms/sketch/src/templates.js","webpack://exports/./platforms/sketch/src/view/templates.html"],"names":["_typeof","obj","Symbol","iterator","module","exports","constructor","prototype","promiseFinally","callback","then","value","resolve","reason","reject","noop","Promise","fn","TypeError","_state","_handled","_value","undefined","_deferreds","doResolve","handle","self","deferred","push","_immediateFn","cb","onFulfilled","onRejected","promise","ret","e","newValue","finale","bind","length","_unhandledRejectionFn","i","len","Handler","done","_multipleResolvesFn","ex","prom","all","arr","Array","isArray","args","slice","call","remaining","res","val","race","setImmediate","err","process","listenerCount","emit","console","warn","type","R","Reflect","ReflectApply","apply","target","receiver","Function","ReflectOwnKeys","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","ProcessEmitWarning","warning","NumberIsNaN","Number","isNaN","EventEmitter","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","defineProperty","enumerable","get","set","arg","RangeError","getPrototypeOf","create","setMaxListeners","n","_getMaxListeners","that","getMaxListeners","arguments","doError","events","error","er","Error","message","context","handler","listeners","arrayClone","_addListener","prepend","m","existing","newListener","unshift","warned","w","String","name","emitter","count","addListener","on","prependListener","onceWrapper","fired","removeListener","wrapFn","_onceWrap","state","wrapped","once","prependOnceListener","list","position","originalListener","shift","spliceOne","off","removeAllListeners","keys","key","_listeners","unwrap","evlistener","unwrapListeners","rawListeners","eventNames","copy","index","pop","MochaDelegate","definition","superclass","uniqueClassName","NSUUID","UUID","UUIDString","delegateClassDesc","MOClassDescription","allocateDescriptionForClassWithName_superclass_","NSObject","handlers","ivars","setHandlerForSelector","selectorString","func","handlerHasBeenSet","selector","NSSelectorFromString","regex","exec","dynamicFunction","eval","join","addInstanceMethodWithSelector_function","setIvar","ivarHasBeenSet","addInstanceVariableWithName_typeEncoding","description","MOPropertyDescription","new","typeEncoding","weak","ivarName","addProperty","getClass","NSClassFromString","getClassInstance","instanceVariables","instance","forEach","registerClass","parseHexColor","color","isKindOfClass","NSColor","source","substr","hex","whiteColor","r","parseInt","g","b","a","colorWithSRGBRed_green_blue_alpha","browserWindow","panel","webview","_panel","_webview","_destroyed","destroy","close","delegate","utils","parentWindow","shouldClose","defaultPrevented","preventDefault","endSheet","isClosable","performClose","focus","focused","isVisible","NSApplication","sharedApplication","activateIgnoringOtherApps","makeKeyAndOrderFront","orderBack","NSApp","mainWindow","blur","isFocused","isKeyWindow","isDestroyed","show","beginSheet_completionHandler","__mocha__","createBlock_function","showInactive","orderFrontRegardless","hide","orderOut","isModal","maximize","isMaximized","zoom","unmaximize","styleMask","NSResizableWindowMask","isZoomed","rectScreen","NSScreen","mainScreen","visibleFrame","rectWindow","frame","origin","x","y","size","width","height","minimize","miniaturize","restore","deminiaturize","isMinimized","isMiniaturized","setFullScreen","fullscreen","isFullscreen","toggleFullScreen","NSFullScreenWindowMask","setAspectRatio","aspectRatio","NSMakeSize","setResizeIncrements","setBounds","bounds","animate","newBounds","assign","getBounds","cocoaBounds","NSMakeRect","screen","screens","firstObject","NSHeight","setFrame_display_animate","mainScreenRect","Math","round","setContentBounds","getContentBounds","setSize","getSize","setContentSize","getContentSize","setMinimumSize","minSize","CGSizeMake","setContentMinSize","getMinimumSize","contentMinSize","setMaximumSize","maxSize","setContentMaxSize","getMaximumSize","contentMaxSize","setResizable","resizable","_setStyleMask","isResizable","setMovable","movable","isMovable","setMinimizable","minimizable","NSMiniaturizableWindowMask","isMinimizable","setMaximizable","maximizable","standardWindowButton","NSWindowZoomButton","setEnabled","isMaximizable","isEnabled","setFullScreenable","fullscreenable","_setCollectionBehavior","NSWindowCollectionBehaviorFullScreenPrimary","NSWindowCollectionBehaviorFullScreenAuxiliary","isFullScreenable","collectionBehavior","setClosable","closable","NSClosableWindowMask","setAlwaysOnTop","top","level","relativeLevel","windowLevel","NSNormalWindowLevel","maxWindowLevel","CGWindowLevelForKey","kCGMaximumWindowLevelKey","minWindowLevel","kCGMinimumWindowLevelKey","NSTornOffMenuWindowLevel","NSModalPanelWindowLevel","NSMainMenuWindowLevel","NSStatusWindowLevel","NSPopUpMenuWindowLevel","NSScreenSaverWindowLevel","NSDockWindowLevel","NSFloatingWindowLevel","newLevel","setLevel","isAlwaysOnTop","moveTop","center","setPosition","getPosition","setTitle","title","getTitle","attentionRequestId","flashFrame","flash","requestUserAttention","NSInformationalRequest","cancelUserAttentionRequest","getNativeWindowHandle","getNativeWebViewHandle","loadURL","url","test","__command","pluginBundle","urlForResourceNamed","path","NSString","alloc","initWithString","stringByAddingPercentEncodingWithAllowedCharacters","NSCharacterSet","URLQueryAllowedCharacterSet","loadFileURL_allowingReadAccessToURL","NSURL","URLWithString","properURL","urlRequest","NSURLRequest","requestWithURL","loadRequest","reload","setHasShadow","hasShadow","setOpacity","opacity","setAlphaValue","getOpacity","alphaValue","setVisibleOnAllWorkspaces","visible","NSWindowCollectionBehaviorCanJoinAllSpaces","isVisibleOnAllWorkspaces","setIgnoreMouseEvents","ignore","setIgnoresMouseEvents","setContentProtection","enable","setSharingType","NSWindowSharingNone","NSWindowSharingReadOnly","setAutoHideCursor","autoHide","setDisableAutoHideCursor","setVibrancy","effectView","_vibrantView","removeFromSuperview","setVibrantView","contentView","NSVisualEffectView","initWithFrame","setAutoresizingMask","NSViewWidthSizable","NSViewHeightSizable","setBlendingMode","NSVisualEffectBlendingModeBehindWindow","setState","NSVisualEffectStateActive","setFrame","addSubview_positioned_relativeTo","NSWindowBelow","vibrancyType","NSVisualEffectMaterialLight","NSVisualEffectMaterialAppearanceBased","NSVisualEffectMaterialDark","NSVisualEffectMaterialTitlebar","NSVisualEffectMaterialSelection","NSVisualEffectMaterialMenu","NSVisualEffectMaterialPopover","NSVisualEffectMaterialSidebar","NSVisualEffectMaterialMediumLight","NSVisualEffectMaterialUltraDark","setMaterial","_setBackgroundColor","colorName","setValue_forKey","backgroundColor","_invalidate","flushWindow","setNeedsDisplay","flag","wasMaximizable","setStyleMask","setCollectionBehavior","_showWindowButton","button","view","superview","addSubview_positioned_relative","NSWindowAbove","JS_BRIDGE","JS_BRIDGE_RESULT_SUCCESS","JS_BRIDGE_RESULT_ERROR","START_MOVING_WINDOW","EXECUTE_JAVASCRIPT","EXECUTE_JAVASCRIPT_SUCCESS","EXECUTE_JAVASCRIPT_ERROR","tagsToFocus","webView","event","point","convertPoint_fromView","locationInWindow","CONSTANTS","require","executeJavaScript","script","userGesture","fiber","coscript","createFiber","navigationDelegate","wasReady","catch","cleanup","requestId","random","webContents","err2","evaluateJavaScript_completionHandler","wrapScript","JSON","stringify","injectScript","WKUserScript","initWithSource_injectionTime_forMainFrameOnly","configuration","userContentController","addUserScript","addEdgeConstraint","edge","subview","constant","addConstraint","NSLayoutConstraint","constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant","NSLayoutRelationEqual","fitSubviewToView","constants","setTranslatesAutoresizingMaskIntoConstraints","NSLayoutAttributeLeft","NSLayoutAttributeTop","NSLayoutAttributeRight","NSLayoutAttributeBottom","buildBrowserAPI","buildWebAPI","dispatchFirstClick","injectClientMessaging","movableArea","setDelegates","BrowserWindow","options","identifier","threadDictionary","NSThread","mainThread","existingBrowserWindow","fromId","id","modal","parent","NSWidth","titleBarStyle","useStandardWindow","windowType","NSTitledWindowMask","transparent","NSTexturedBackgroundWindowMask","NSPanel","initWithContentRect_styleMask_backing_defer","NSBackingStoreBuffered","wkwebviewConfig","WKWebViewConfiguration","WKWebView","initWithFrame_configuration","CGRectMake","kCGDesktopWindowLevel","NSWindowCollectionBehaviorStationary","NSWindowCollectionBehaviorIgnoresCycle","minWidth","minHeight","maxWidth","maxHeight","titlebarAppearsTransparent","titleVisibility","NSWindowTitleHidden","setOpaque","isMovableByWindowBackground","toolbar2","NSToolbar","initWithIdentifier","setShowsBaselineSeparator","setToolbar","toolbar","useContentSize","alwaysOnTop","clearColor","vibrancy","windowBackgroundColor","webPreferences","preferences","devTools","javascript","plugins","minimumFontSize","zoomFactor","setMagnification","addSubview","NSWindowFullScreenButton","setHidden","NSWindowMiniaturizeButton","NSWindowCloseButton","setHidesOnDeactivate","hidesOnDeactivate","remembersWindowFrame","setFrameAutosaveName","setFrameUsingName_force","frameAutosaveName","acceptsFirstMouse","NSEventTypeLeftMouseDown","setupHandler","removeObjectForKey","observer","removeObserver_forKeyPath","onCleanup","fromPanel","subviews","WKInspectorWKWebView","initialMouseLocation","initialWindowPosition","interval","moveWindow","NSEvent","pressedMouseButtons","clearInterval","mouse","mouseLocation","setInterval","webArguments","parse","ObjCClass","parseWebArguments","WindowDelegateClass","NavigationDelegateClass","WebScriptHandlerClass","ThemeObserverClass","MSTheme","sharedTheme","isDark","currentEvent","URL","navigation","emitBrowserEvent","_","body","themeObserver","addObserver_forKeyPath_options_context","NSKeyValueChangeNewKey","setNavigationDelegate","webScriptHandler","map","l","addScriptMessageHandler_name","msdocument","sketchObject","class","windowForSheet","windowDelegate","setDelegate","buildAPI","loadFile","downloadURL","getURL","isLoading","loading","isLoadingMainFrame","isWaitingForResponse","stop","stopLoading","reloadIgnoringCache","reloadFromOrigin","canGoBack","canGoForward","canGoToOffset","offset","backForwardList","itemAtIndex","clearHistory","goBack","goForward","goToIndex","backList","backListLength","forwardList","goToOffset","isCrashed","setUserAgent","getUserAgent","userAgent","customUserAgent","insertCSS","css","replace","insertJS","setIgnoreMenuShortcuts","setAudioMuted","isAudioMuted","setZoomFactor","factor","setMagnification_centeredAtPoint","CGPointMake","getZoomFactor","magnification","setZoomLevel","pow","getZoomLevel","log","setVisualZoomLevelLimits","setLayoutZoomLevelLimits","send","getNativeWebview","getWebview","isWebviewPresent","sendToWebview","evalString","webviewIdentifier","onShutdown","existingWebview"],"mappings":"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","file":"__templates.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./platforms/sketch/src/templates.js\");\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","/* from https://github.com/taylorhakes/promise-polyfill */\n\nfunction promiseFinally(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nfunction noop() {}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError(\"Promises must be constructed via new\");\n  if (typeof fn !== \"function\") throw new TypeError(\"not a function\");\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError(\"A promise cannot be resolved with itself.\");\n    if (\n      newValue &&\n      (typeof newValue === \"object\" || typeof newValue === \"function\")\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === \"function\") {\n        doResolve(then.bind(newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value, self);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) {\n          Promise._multipleResolvesFn(\"resolve\", self, value);\n          return;\n        }\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) {\n          Promise._multipleResolvesFn(\"reject\", self, reason);\n          return;\n        }\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) {\n      Promise._multipleResolvesFn(\"reject\", self, ex);\n      return;\n    }\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype[\"catch\"] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype[\"finally\"] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.all accepts an array\"));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === \"object\" || typeof val === \"function\")) {\n          var then = val.then;\n          if (typeof then === \"function\") {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === \"object\" && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.race accepts an array\"));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn = setImmediate;\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err, promise) {\n  if (\n    typeof process !== \"undefined\" &&\n    process.listenerCount &&\n    (process.listenerCount(\"unhandledRejection\") ||\n      process.listenerCount(\"uncaughtException\"))\n  ) {\n    process.emit(\"unhandledRejection\", err, promise);\n    process.emit(\"uncaughtException\", err, \"unhandledRejection\");\n  } else if (typeof console !== \"undefined\" && console) {\n    console.warn(\"Possible Unhandled Promise Rejection:\", err);\n  }\n};\n\nPromise._multipleResolvesFn = function _multipleResolvesFn(\n  type,\n  promise,\n  value\n) {\n  if (typeof process !== \"undefined\" && process.emit) {\n    process.emit(\"multipleResolves\", type, promise, value);\n  }\n};\n\nmodule.exports = Promise;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","/* globals MOClassDescription, NSObject, NSSelectorFromString, NSClassFromString, MOPropertyDescription */\n\nmodule.exports = function MochaDelegate(definition, superclass) {\n  var uniqueClassName =\n    'MochaJSDelegate_DynamicClass_' + NSUUID.UUID().UUIDString()\n\n  var delegateClassDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(\n    uniqueClassName,\n    superclass || NSObject\n  )\n\n  // Storage\n  var handlers = {}\n  var ivars = {}\n\n  // Define an instance method\n  function setHandlerForSelector(selectorString, func) {\n    var handlerHasBeenSet = selectorString in handlers\n    var selector = NSSelectorFromString(selectorString)\n\n    handlers[selectorString] = func\n\n    /*\n      For some reason, Mocha acts weird about arguments: https://github.com/logancollins/Mocha/issues/28\n      We have to basically create a dynamic handler with a likewise dynamic number of predefined arguments.\n    */\n    if (!handlerHasBeenSet) {\n      var args = []\n      var regex = /:/g\n      while (regex.exec(selectorString)) {\n        args.push('arg' + args.length)\n      }\n\n      // eslint-disable-next-line no-eval\n      var dynamicFunction = eval(\n        '(function (' +\n          args.join(', ') +\n          ') { return handlers[selectorString].apply(this, arguments); })'\n      )\n\n      delegateClassDesc.addInstanceMethodWithSelector_function(\n        selector,\n        dynamicFunction\n      )\n    }\n  }\n\n  // define a property\n  function setIvar(key, value) {\n    var ivarHasBeenSet = key in handlers\n\n    ivars[key] = value\n\n    if (!ivarHasBeenSet) {\n      delegateClassDesc.addInstanceVariableWithName_typeEncoding(key, '@')\n      var description = MOPropertyDescription.new()\n      description.name = key\n      description.typeEncoding = '@'\n      description.weak = true\n      description.ivarName = key\n      delegateClassDesc.addProperty(description)\n    }\n  }\n\n  this.getClass = function() {\n    return NSClassFromString(uniqueClassName)\n  }\n\n  this.getClassInstance = function(instanceVariables) {\n    var instance = NSClassFromString(uniqueClassName).new()\n    Object.keys(ivars).forEach(function(key) {\n      instance[key] = ivars[key]\n    })\n    Object.keys(instanceVariables || {}).forEach(function(key) {\n      instance[key] = instanceVariables[key]\n    })\n    return instance\n  }\n  // alias\n  this.new = this.getClassInstance\n\n  // Convenience\n  if (typeof definition === 'object') {\n    Object.keys(definition).forEach(\n      function(key) {\n        if (typeof definition[key] === 'function') {\n          setHandlerForSelector(key, definition[key])\n        } else {\n          setIvar(key, definition[key])\n        }\n      }\n    )\n  }\n\n  delegateClassDesc.registerClass()\n}\n","function parseHexColor(color) {\n  // Check the string for incorrect formatting.\n  if (!color || color[0] !== '#') {\n    if (\n      color &&\n      typeof color.isKindOfClass === 'function' &&\n      color.isKindOfClass(NSColor)\n    ) {\n      return color\n    }\n    throw new Error(\n      'Incorrect color formating. It should be an hex color: #RRGGBBAA'\n    )\n  }\n\n  // append FF if alpha channel is not specified.\n  var source = color.substr(1)\n  if (source.length === 3) {\n    source += 'F'\n  } else if (source.length === 6) {\n    source += 'FF'\n  }\n  // Convert the string from #FFF format to #FFFFFF format.\n  var hex\n  if (source.length === 4) {\n    for (var i = 0; i < 4; i += 1) {\n      hex += source[i]\n      hex += source[i]\n    }\n  } else if (source.length === 8) {\n    hex = source\n  } else {\n    return NSColor.whiteColor()\n  }\n\n  var r = parseInt(hex.slice(0, 2), 16)\n  var g = parseInt(hex.slice(2, 4), 16)\n  var b = parseInt(hex.slice(4, 6), 16)\n  var a = parseInt(hex.slice(6, 8), 16)\n\n  return NSColor.colorWithSRGBRed_green_blue_alpha(r, g, b, a)\n}\n\nmodule.exports = function(browserWindow, panel, webview) {\n  // keep reference to the subviews\n  browserWindow._panel = panel\n  browserWindow._webview = webview\n  browserWindow._destroyed = false\n\n  browserWindow.destroy = function() {\n    return panel.close()\n  }\n\n  browserWindow.close = function() {\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      var shouldClose = true\n      browserWindow.emit('close', {\n        get defaultPrevented() {\n          return !shouldClose\n        },\n        preventDefault: function() {\n          shouldClose = false\n        },\n      })\n      if (shouldClose) {\n        panel.delegate().utils.parentWindow.endSheet(panel)\n      }\n      return\n    }\n\n    if (!browserWindow.isClosable()) {\n      return\n    }\n\n    panel.performClose(null)\n  }\n\n  function focus(focused) {\n    if (!browserWindow.isVisible()) {\n      return\n    }\n    if (focused) {\n      NSApplication.sharedApplication().activateIgnoringOtherApps(true)\n      panel.makeKeyAndOrderFront(null)\n    } else {\n      panel.orderBack(null)\n      NSApp.mainWindow().makeKeyAndOrderFront(null)\n    }\n  }\n\n  browserWindow.focus = focus.bind(this, true)\n  browserWindow.blur = focus.bind(this, false)\n\n  browserWindow.isFocused = function() {\n    return panel.isKeyWindow()\n  }\n\n  browserWindow.isDestroyed = function() {\n    return browserWindow._destroyed\n  }\n\n  browserWindow.show = function() {\n    // This method is supposed to put focus on window, however if the app does not\n    // have focus then \"makeKeyAndOrderFront\" will only show the window.\n    NSApp.activateIgnoringOtherApps(true)\n\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      return panel.delegate().utils.parentWindow.beginSheet_completionHandler(\n        panel,\n        __mocha__.createBlock_function('v16@?0q8', function() {\n          browserWindow.emit('closed')\n        })\n      )\n    }\n\n    return panel.makeKeyAndOrderFront(null)\n  }\n\n  browserWindow.showInactive = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.hide = function() {\n    return panel.orderOut(null)\n  }\n\n  browserWindow.isVisible = function() {\n    return panel.isVisible()\n  }\n\n  browserWindow.isModal = function() {\n    return false\n  }\n\n  browserWindow.maximize = function() {\n    if (!browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n  browserWindow.unmaximize = function() {\n    if (browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n\n  browserWindow.isMaximized = function() {\n    if ((panel.styleMask() & NSResizableWindowMask) !== 0) {\n      return panel.isZoomed()\n    }\n    var rectScreen = NSScreen.mainScreen().visibleFrame()\n    var rectWindow = panel.frame()\n    return (\n      rectScreen.origin.x == rectWindow.origin.x &&\n      rectScreen.origin.y == rectWindow.origin.y &&\n      rectScreen.size.width == rectWindow.size.width &&\n      rectScreen.size.height == rectWindow.size.height\n    )\n  }\n\n  browserWindow.minimize = function() {\n    return panel.miniaturize(null)\n  }\n\n  browserWindow.restore = function() {\n    return panel.deminiaturize(null)\n  }\n\n  browserWindow.isMinimized = function() {\n    return panel.isMiniaturized()\n  }\n\n  browserWindow.setFullScreen = function(fullscreen) {\n    if (fullscreen !== browserWindow.isFullscreen()) {\n      panel.toggleFullScreen(null)\n    }\n  }\n\n  browserWindow.isFullscreen = function() {\n    return panel.styleMask() & NSFullScreenWindowMask\n  }\n\n  browserWindow.setAspectRatio = function(aspectRatio /* , extraSize */) {\n    // Reset the behaviour to default if aspect_ratio is set to 0 or less.\n    if (aspectRatio > 0.0) {\n      panel.setAspectRatio(NSMakeSize(aspectRatio, 1.0))\n    } else {\n      panel.setResizeIncrements(NSMakeSize(1.0, 1.0))\n    }\n  }\n\n  browserWindow.setBounds = function(bounds, animate) {\n    if (!bounds) {\n      return\n    }\n\n    // Do nothing if in fullscreen mode.\n    if (browserWindow.isFullscreen()) {\n      return\n    }\n\n    const newBounds = Object.assign(browserWindow.getBounds(), bounds)\n\n    // TODO: Check size constraints since setFrame does not check it.\n    // var size = bounds.size\n    // size.SetToMax(GetMinimumSize());\n    // gfx::Size max_size = GetMaximumSize();\n    // if (!max_size.IsEmpty())\n    //   size.SetToMin(max_size);\n\n    var cocoaBounds = NSMakeRect(\n      newBounds.x,\n      0,\n      newBounds.width,\n      newBounds.height\n    )\n    // Flip Y coordinates based on the primary screen\n    var screen = NSScreen.screens().firstObject()\n    cocoaBounds.origin.y = NSHeight(screen.frame()) - newBounds.y\n\n    panel.setFrame_display_animate(cocoaBounds, true, animate)\n  }\n\n  browserWindow.getBounds = function() {\n    const cocoaBounds = panel.frame()\n    var mainScreenRect = NSScreen.screens()\n      .firstObject()\n      .frame()\n    return {\n      x: cocoaBounds.origin.x,\n      y: Math.round(NSHeight(mainScreenRect) - cocoaBounds.origin.y),\n      width: cocoaBounds.size.width,\n      height: cocoaBounds.size.height,\n    }\n  }\n\n  browserWindow.setContentBounds = function(bounds, animate) {\n    // TODO:\n    browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getContentBounds = function() {\n    // TODO:\n    return browserWindow.getBounds()\n  }\n\n  browserWindow.setSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setBounds({ width: width, height: height }, animate)\n  }\n\n  browserWindow.getSize = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setContentSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setContentBounds(\n      { width: width, height: height },\n      animate\n    )\n  }\n\n  browserWindow.getContentSize = function() {\n    var bounds = browserWindow.getContentBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setMinimumSize = function(width, height) {\n    const minSize = CGSizeMake(width, height)\n    panel.setContentMinSize(minSize)\n  }\n\n  browserWindow.getMinimumSize = function() {\n    const size = panel.contentMinSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setMaximumSize = function(width, height) {\n    const maxSize = CGSizeMake(width, height)\n    panel.setContentMaxSize(maxSize)\n  }\n\n  browserWindow.getMaximumSize = function() {\n    const size = panel.contentMaxSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setResizable = function(resizable) {\n    return browserWindow._setStyleMask(resizable, NSResizableWindowMask)\n  }\n\n  browserWindow.isResizable = function() {\n    return panel.styleMask() & NSResizableWindowMask\n  }\n\n  browserWindow.setMovable = function(movable) {\n    return panel.setMovable(movable)\n  }\n  browserWindow.isMovable = function() {\n    return panel.isMovable()\n  }\n\n  browserWindow.setMinimizable = function(minimizable) {\n    return browserWindow._setStyleMask(minimizable, NSMiniaturizableWindowMask)\n  }\n\n  browserWindow.isMinimizable = function() {\n    return panel.styleMask() & NSMiniaturizableWindowMask\n  }\n\n  browserWindow.setMaximizable = function(maximizable) {\n    if (panel.standardWindowButton(NSWindowZoomButton)) {\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(maximizable)\n    }\n  }\n\n  browserWindow.isMaximizable = function() {\n    return (\n      panel.standardWindowButton(NSWindowZoomButton) &&\n      panel.standardWindowButton(NSWindowZoomButton).isEnabled()\n    )\n  }\n\n  browserWindow.setFullScreenable = function(fullscreenable) {\n    browserWindow._setCollectionBehavior(\n      fullscreenable,\n      NSWindowCollectionBehaviorFullScreenPrimary\n    )\n    // On EL Capitan this flag is required to hide fullscreen button.\n    browserWindow._setCollectionBehavior(\n      !fullscreenable,\n      NSWindowCollectionBehaviorFullScreenAuxiliary\n    )\n  }\n\n  browserWindow.isFullScreenable = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorFullScreenPrimary\n  }\n\n  browserWindow.setClosable = function(closable) {\n    browserWindow._setStyleMask(closable, NSClosableWindowMask)\n  }\n\n  browserWindow.isClosable = function() {\n    return panel.styleMask() & NSClosableWindowMask\n  }\n\n  browserWindow.setAlwaysOnTop = function(top, level, relativeLevel) {\n    var windowLevel = NSNormalWindowLevel\n    var maxWindowLevel = CGWindowLevelForKey(kCGMaximumWindowLevelKey)\n    var minWindowLevel = CGWindowLevelForKey(kCGMinimumWindowLevelKey)\n\n    if (top) {\n      if (level === 'normal') {\n        windowLevel = NSNormalWindowLevel\n      } else if (level === 'torn-off-menu') {\n        windowLevel = NSTornOffMenuWindowLevel\n      } else if (level === 'modal-panel') {\n        windowLevel = NSModalPanelWindowLevel\n      } else if (level === 'main-menu') {\n        windowLevel = NSMainMenuWindowLevel\n      } else if (level === 'status') {\n        windowLevel = NSStatusWindowLevel\n      } else if (level === 'pop-up-menu') {\n        windowLevel = NSPopUpMenuWindowLevel\n      } else if (level === 'screen-saver') {\n        windowLevel = NSScreenSaverWindowLevel\n      } else if (level === 'dock') {\n        // Deprecated by macOS, but kept for backwards compatibility\n        windowLevel = NSDockWindowLevel\n      } else {\n        windowLevel = NSFloatingWindowLevel\n      }\n    }\n\n    var newLevel = windowLevel + (relativeLevel || 0)\n    if (newLevel >= minWindowLevel && newLevel <= maxWindowLevel) {\n      panel.setLevel(newLevel)\n    } else {\n      throw new Error(\n        'relativeLevel must be between ' +\n          minWindowLevel +\n          ' and ' +\n          maxWindowLevel\n      )\n    }\n  }\n\n  browserWindow.isAlwaysOnTop = function() {\n    return panel.level() !== NSNormalWindowLevel\n  }\n\n  browserWindow.moveTop = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.center = function() {\n    panel.center()\n  }\n\n  browserWindow.setPosition = function(x, y, animate) {\n    return browserWindow.setBounds({ x: x, y: y }, animate)\n  }\n\n  browserWindow.getPosition = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.x, bounds.y]\n  }\n\n  browserWindow.setTitle = function(title) {\n    panel.setTitle(title)\n  }\n\n  browserWindow.getTitle = function() {\n    return String(panel.title())\n  }\n\n  var attentionRequestId = 0\n  browserWindow.flashFrame = function(flash) {\n    if (flash) {\n      attentionRequestId = NSApp.requestUserAttention(NSInformationalRequest)\n    } else {\n      NSApp.cancelUserAttentionRequest(attentionRequestId)\n      attentionRequestId = 0\n    }\n  }\n\n  browserWindow.getNativeWindowHandle = function() {\n    return panel\n  }\n\n  browserWindow.getNativeWebViewHandle = function() {\n    return webview\n  }\n\n  browserWindow.loadURL = function(url) {\n    // When frameLocation is a file, prefix it with the Sketch Resources path\n    if (/^(?!https?|file).*\\.html?$/.test(url)) {\n      if (typeof __command !== 'undefined' && __command.pluginBundle()) {\n        url =\n          'file://' +\n          __command\n            .pluginBundle()\n            .urlForResourceNamed(url)\n            .path()\n      }\n    }\n\n    if (/^file:\\/\\/.*\\.html?$/.test(url)) {\n      // ensure URLs containing spaces are properly handled\n      url = NSString.alloc().initWithString(url)\n      url = url.stringByAddingPercentEncodingWithAllowedCharacters(\n        NSCharacterSet.URLQueryAllowedCharacterSet()\n      )\n      webview.loadFileURL_allowingReadAccessToURL(\n        NSURL.URLWithString(url),\n        NSURL.URLWithString('file:///')\n      )\n      return\n    }\n\n    const properURL = NSURL.URLWithString(url)\n    const urlRequest = NSURLRequest.requestWithURL(properURL)\n\n    webview.loadRequest(urlRequest)\n  }\n\n  browserWindow.reload = function() {\n    webview.reload()\n  }\n\n  browserWindow.setHasShadow = function(hasShadow) {\n    return panel.setHasShadow(hasShadow)\n  }\n\n  browserWindow.hasShadow = function() {\n    return panel.hasShadow()\n  }\n\n  browserWindow.setOpacity = function(opacity) {\n    return panel.setAlphaValue(opacity)\n  }\n\n  browserWindow.getOpacity = function() {\n    return panel.alphaValue()\n  }\n\n  browserWindow.setVisibleOnAllWorkspaces = function(visible) {\n    return browserWindow._setCollectionBehavior(\n      visible,\n      NSWindowCollectionBehaviorCanJoinAllSpaces\n    )\n  }\n\n  browserWindow.isVisibleOnAllWorkspaces = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorCanJoinAllSpaces\n  }\n\n  browserWindow.setIgnoreMouseEvents = function(ignore) {\n    return panel.setIgnoresMouseEvents(ignore)\n  }\n\n  browserWindow.setContentProtection = function(enable) {\n    panel.setSharingType(enable ? NSWindowSharingNone : NSWindowSharingReadOnly)\n  }\n\n  browserWindow.setAutoHideCursor = function(autoHide) {\n    panel.setDisableAutoHideCursor(autoHide)\n  }\n\n  browserWindow.setVibrancy = function(type) {\n    var effectView = browserWindow._vibrantView\n\n    if (!type) {\n      if (effectView == null) {\n        return\n      }\n\n      effectView.removeFromSuperview()\n      panel.setVibrantView(null)\n      return\n    }\n\n    if (effectView == null) {\n      var contentView = panel.contentView()\n      effectView = NSVisualEffectView.alloc().initWithFrame(\n        contentView.bounds()\n      )\n      browserWindow._vibrantView = effectView\n\n      effectView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n      effectView.setBlendingMode(NSVisualEffectBlendingModeBehindWindow)\n      effectView.setState(NSVisualEffectStateActive)\n      effectView.setFrame(contentView.bounds())\n      contentView.addSubview_positioned_relativeTo(\n        effectView,\n        NSWindowBelow,\n        null\n      )\n    }\n\n    var vibrancyType = NSVisualEffectMaterialLight\n\n    if (type === 'appearance-based') {\n      vibrancyType = NSVisualEffectMaterialAppearanceBased\n    } else if (type === 'light') {\n      vibrancyType = NSVisualEffectMaterialLight\n    } else if (type === 'dark') {\n      vibrancyType = NSVisualEffectMaterialDark\n    } else if (type === 'titlebar') {\n      vibrancyType = NSVisualEffectMaterialTitlebar\n    } else if (type === 'selection') {\n      vibrancyType = NSVisualEffectMaterialSelection\n    } else if (type === 'menu') {\n      vibrancyType = NSVisualEffectMaterialMenu\n    } else if (type === 'popover') {\n      vibrancyType = NSVisualEffectMaterialPopover\n    } else if (type === 'sidebar') {\n      vibrancyType = NSVisualEffectMaterialSidebar\n    } else if (type === 'medium-light') {\n      vibrancyType = NSVisualEffectMaterialMediumLight\n    } else if (type === 'ultra-dark') {\n      vibrancyType = NSVisualEffectMaterialUltraDark\n    }\n\n    effectView.setMaterial(vibrancyType)\n  }\n\n  browserWindow._setBackgroundColor = function(colorName) {\n    var color = parseHexColor(colorName)\n    webview.setValue_forKey(false, 'drawsBackground')\n    panel.backgroundColor = color\n  }\n\n  browserWindow._invalidate = function() {\n    panel.flushWindow()\n    panel.contentView().setNeedsDisplay(true)\n  }\n\n  browserWindow._setStyleMask = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setStyleMask(panel.styleMask() | flag)\n    } else {\n      panel.setStyleMask(panel.styleMask() & ~flag)\n    }\n    // Change style mask will make the zoom button revert to default, probably\n    // a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._setCollectionBehavior = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setCollectionBehavior(panel.collectionBehavior() | flag)\n    } else {\n      panel.setCollectionBehavior(panel.collectionBehavior() & ~flag)\n    }\n    // Change collectionBehavior will make the zoom button revert to default,\n    // probably a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._showWindowButton = function(button) {\n    var view = panel.standardWindowButton(button)\n    view.superview().addSubview_positioned_relative(view, NSWindowAbove, null)\n  }\n}\n","module.exports = {\n  JS_BRIDGE: '__skpm_sketchBridge',\n  JS_BRIDGE_RESULT_SUCCESS: '__skpm_sketchBridge_success',\n  JS_BRIDGE_RESULT_ERROR: '__skpm_sketchBridge_error',\n  START_MOVING_WINDOW: '__skpm_startMovingWindow',\n  EXECUTE_JAVASCRIPT: '__skpm_executeJS',\n  EXECUTE_JAVASCRIPT_SUCCESS: '__skpm_executeJS_success_',\n  EXECUTE_JAVASCRIPT_ERROR: '__skpm_executeJS_error_',\n}\n","var tagsToFocus =\n  '[\"text\", \"textarea\", \"date\", \"datetime-local\", \"email\", \"number\", \"month\", \"password\", \"search\", \"tel\", \"time\", \"url\", \"week\" ]'\n\nmodule.exports = function(webView, event) {\n  var point = webView.convertPoint_fromView(event.locationInWindow(), null)\n  return (\n    'var el = document.elementFromPoint(' + // get the DOM element that match the event\n    point.x +\n    ', ' +\n    point.y +\n    '); ' +\n    'if (el && el.tagName === \"SELECT\") {' + // select needs special handling\n    '  var event = document.createEvent(\"MouseEvents\");' +\n    '  event.initMouseEvent(\"mousedown\", true, true, window);' +\n    '  el.dispatchEvent(event);' +\n    '} else if (el && ' + // some tags need to be focused instead of clicked\n    tagsToFocus +\n    '.indexOf(el.type) >= 0 && ' +\n    'el.focus' +\n    ') {' +\n    'el.focus();' + // so focus them\n    '} else if (el) {' +\n    'el.dispatchEvent(new Event(\"click\", {bubbles: true}))' + // click the others\n    '}'\n  )\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webview, browserWindow) {\n  function executeJavaScript(script, userGesture, callback) {\n    if (typeof userGesture === 'function') {\n      callback = userGesture\n      userGesture = false\n    }\n    var fiber = coscript.createFiber()\n\n    // if the webview is not ready yet, defer the execution until it is\n    if (\n      webview.navigationDelegate().state &&\n      webview.navigationDelegate().state.wasReady == 0\n    ) {\n      return new Promise(function(resolve, reject) {\n        browserWindow.once('ready-to-show', function() {\n          executeJavaScript(script, userGesture, callback)\n            .then(resolve)\n            .catch(reject)\n          fiber.cleanup()\n        })\n      })\n    }\n\n    return new Promise(function(resolve, reject) {\n      var requestId = Math.random()\n\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS + requestId,\n        function(res) {\n          try {\n            if (callback) {\n              callback(null, res)\n            }\n            resolve(res)\n          } catch (err) {\n            reject(err)\n          }\n          fiber.cleanup()\n        }\n      )\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_ERROR + requestId,\n        function(err) {\n          try {\n            if (callback) {\n              callback(err)\n              resolve()\n            } else {\n              reject(err)\n            }\n          } catch (err2) {\n            reject(err2)\n          }\n          fiber.cleanup()\n        }\n      )\n\n      webview.evaluateJavaScript_completionHandler(\n        module.exports.wrapScript(script, requestId),\n        null\n      )\n    })\n  }\n\n  return executeJavaScript\n}\n\nmodule.exports.wrapScript = function(script, requestId) {\n  return (\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    '(' +\n    requestId +\n    ', ' +\n    JSON.stringify(script) +\n    ')'\n  )\n}\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    ' = function(id, script) {' +\n    '  try {' +\n    '    var res = eval(script);' +\n    '    if (res && typeof res.then === \"function\" && typeof res.catch === \"function\") {' +\n    '      res.then(function (res2) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res2);' +\n    '      })' +\n    '      .catch(function (err) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '      })' +\n    '    } else {' +\n    '      window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res);' +\n    '    }' +\n    '  } catch (err) {' +\n    '    window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '  }' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","function addEdgeConstraint(edge, subview, view, constant) {\n  view.addConstraint(\n    NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n      subview,\n      edge,\n      NSLayoutRelationEqual,\n      view,\n      edge,\n      1,\n      constant\n    )\n  )\n}\nmodule.exports = function fitSubviewToView(subview, view, constants) {\n  constants = constants || []\n  subview.setTranslatesAutoresizingMaskIntoConstraints(false)\n\n  addEdgeConstraint(NSLayoutAttributeLeft, subview, view, constants[0] || 0)\n  addEdgeConstraint(NSLayoutAttributeTop, subview, view, constants[1] || 0)\n  addEdgeConstraint(NSLayoutAttributeRight, subview, view, constants[2] || 0)\n  addEdgeConstraint(NSLayoutAttributeBottom, subview, view, constants[3] || 0)\n}\n","/* let's try to match the API from Electron's Browser window\n(https://github.com/electron/electron/blob/master/docs/api/browser-window.md) */\nvar EventEmitter = require('events')\nvar buildBrowserAPI = require('./browser-api')\nvar buildWebAPI = require('./webview-api')\nvar fitSubviewToView = require('./fitSubview')\nvar dispatchFirstClick = require('./dispatch-first-click')\nvar injectClientMessaging = require('./inject-client-messaging')\nvar movableArea = require('./movable-area')\nvar executeJavaScript = require('./execute-javascript')\nvar setDelegates = require('./set-delegates')\n\nfunction BrowserWindow(options) {\n  options = options || {}\n\n  var identifier = options.identifier || NSUUID.UUID().UUIDString()\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  var existingBrowserWindow = BrowserWindow.fromId(identifier)\n\n  // if we already have a window opened, reuse it\n  if (existingBrowserWindow) {\n    return existingBrowserWindow\n  }\n\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (options.modal && !options.parent) {\n    throw new Error('A modal needs to have a parent.')\n  }\n\n  // Long-running script\n  var fiber = coscript.createFiber()\n\n  // Window size\n  var width = options.width || 800\n  var height = options.height || 600\n  var mainScreenRect = NSScreen.screens()\n    .firstObject()\n    .frame()\n  var cocoaBounds = NSMakeRect(\n    typeof options.x !== 'undefined'\n      ? options.x\n      : Math.round((NSWidth(mainScreenRect) - width) / 2),\n    typeof options.y !== 'undefined'\n      ? NSHeight(mainScreenRect) - options.y\n      : Math.round((NSHeight(mainScreenRect) - height) / 2),\n    width,\n    height\n  )\n\n  if (options.titleBarStyle && options.titleBarStyle !== 'default') {\n    options.frame = false\n  }\n\n  var useStandardWindow = options.windowType !== 'textured'\n  var styleMask = NSTitledWindowMask\n\n  // this is commented out because the toolbar doesn't appear otherwise :thinking-face:\n  // if (!useStandardWindow || options.frame === false) {\n  //   styleMask = NSFullSizeContentViewWindowMask\n  // }\n  if (options.minimizable !== false) {\n    styleMask |= NSMiniaturizableWindowMask\n  }\n  if (options.closable !== false) {\n    styleMask |= NSClosableWindowMask\n  }\n  if (options.resizable !== false) {\n    styleMask |= NSResizableWindowMask\n  }\n  if (!useStandardWindow || options.transparent || options.frame === false) {\n    styleMask |= NSTexturedBackgroundWindowMask\n  }\n\n  var panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(\n    cocoaBounds,\n    styleMask,\n    NSBackingStoreBuffered,\n    true\n  )\n\n  var wkwebviewConfig = WKWebViewConfiguration.alloc().init()\n  var webView = WKWebView.alloc().initWithFrame_configuration(\n    CGRectMake(0, 0, options.width || 800, options.height || 600),\n    wkwebviewConfig\n  )\n  injectClientMessaging(webView)\n  webView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n  setDelegates(browserWindow, panel, webView, options)\n\n  if (options.windowType === 'desktop') {\n    panel.setLevel(kCGDesktopWindowLevel - 1)\n    // panel.setCanBecomeKeyWindow(false)\n    panel.setCollectionBehavior(\n      NSWindowCollectionBehaviorCanJoinAllSpaces |\n        NSWindowCollectionBehaviorStationary |\n        NSWindowCollectionBehaviorIgnoresCycle\n    )\n  }\n\n  if (\n    typeof options.minWidth !== 'undefined' ||\n    typeof options.minHeight !== 'undefined'\n  ) {\n    browserWindow.setMinimumSize(options.minWidth || 0, options.minHeight || 0)\n  }\n\n  if (\n    typeof options.maxWidth !== 'undefined' ||\n    typeof options.maxHeight !== 'undefined'\n  ) {\n    browserWindow.setMaximumSize(\n      options.maxWidth || 10000,\n      options.maxHeight || 10000\n    )\n  }\n\n  // if (options.focusable === false) {\n  //   panel.setCanBecomeKeyWindow(false)\n  // }\n\n  if (options.transparent || options.frame === false) {\n    panel.titlebarAppearsTransparent = true\n    panel.titleVisibility = NSWindowTitleHidden\n    panel.setOpaque(0)\n    panel.isMovableByWindowBackground = true\n    var toolbar2 = NSToolbar.alloc().initWithIdentifier(\n      'titlebarStylingToolbar'\n    )\n    toolbar2.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar2)\n  }\n\n  if (options.titleBarStyle === 'hiddenInset') {\n    var toolbar = NSToolbar.alloc().initWithIdentifier('titlebarStylingToolbar')\n    toolbar.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar)\n  }\n\n  if (options.frame === false || !options.useContentSize) {\n    browserWindow.setSize(width, height)\n  }\n\n  if (options.center) {\n    browserWindow.center()\n  }\n\n  if (options.alwaysOnTop) {\n    browserWindow.setAlwaysOnTop(true)\n  }\n\n  if (options.fullscreen) {\n    browserWindow.setFullScreen(true)\n  }\n  browserWindow.setFullScreenable(!!options.fullscreenable)\n\n  let title = options.title\n  if (options.frame === false) {\n    title = undefined\n  } else if (\n    typeof title === 'undefined' &&\n    typeof __command !== 'undefined' &&\n    __command.pluginBundle()\n  ) {\n    title = __command.pluginBundle().name()\n  }\n\n  if (title) {\n    browserWindow.setTitle(title)\n  }\n\n  var backgroundColor = options.backgroundColor\n  if (options.transparent) {\n    backgroundColor = NSColor.clearColor()\n  }\n  if (!backgroundColor && options.frame === false && options.vibrancy) {\n    backgroundColor = NSColor.clearColor()\n  }\n\n  browserWindow._setBackgroundColor(\n    backgroundColor || NSColor.windowBackgroundColor()\n  )\n\n  if (options.hasShadow === false) {\n    browserWindow.setHasShadow(false)\n  }\n\n  if (typeof options.opacity !== 'undefined') {\n    browserWindow.setOpacity(options.opacity)\n  }\n\n  options.webPreferences = options.webPreferences || {}\n\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.devTools !== false,\n      'developerExtrasEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.javascript !== false,\n      'javaScriptEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(!!options.webPreferences.plugins, 'plugInsEnabled')\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.minimumFontSize || 0,\n      'minimumFontSize'\n    )\n\n  if (options.webPreferences.zoomFactor) {\n    webView.setMagnification(options.webPreferences.zoomFactor)\n  }\n\n  var contentView = panel.contentView()\n\n  if (options.frame !== false) {\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n  } else {\n    // In OSX 10.10, adding subviews to the root view for the NSView hierarchy\n    // produces warnings. To eliminate the warnings, we resize the contentView\n    // to fill the window, and add subviews to that.\n    // http://crbug.com/380412\n    contentView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n    fitSubviewToView(contentView, contentView.superview())\n\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n\n    // The fullscreen button should always be hidden for frameless window.\n    if (panel.standardWindowButton(NSWindowFullScreenButton)) {\n      panel.standardWindowButton(NSWindowFullScreenButton).setHidden(true)\n    }\n\n    if (!options.titleBarStyle || options.titleBarStyle === 'default') {\n      // Hide the window buttons.\n      panel.standardWindowButton(NSWindowZoomButton).setHidden(true)\n      panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true)\n      panel.standardWindowButton(NSWindowCloseButton).setHidden(true)\n\n      // Some third-party macOS utilities check the zoom button's enabled state to\n      // determine whether to show custom UI on hover, so we disable it here to\n      // prevent them from doing so in a frameless app window.\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(false)\n    }\n  }\n\n  if (options.vibrancy) {\n    browserWindow.setVibrancy(options.vibrancy)\n  }\n\n  // Set maximizable state last to ensure zoom button does not get reset\n  // by calls to other APIs.\n  browserWindow.setMaximizable(options.maximizable !== false)\n\n  panel.setHidesOnDeactivate(options.hidesOnDeactivate !== false)\n\n  if (options.remembersWindowFrame) {\n    panel.setFrameAutosaveName(identifier)\n    panel.setFrameUsingName_force(panel.frameAutosaveName(), false)\n  }\n\n  if (options.acceptsFirstMouse) {\n    browserWindow.on('focus', function(event) {\n      if (event.type() === NSEventTypeLeftMouseDown) {\n        browserWindow.webContents\n          .executeJavaScript(dispatchFirstClick(webView, event))\n          .catch(() => {})\n      }\n    })\n  }\n\n  executeJavaScript.injectScript(webView)\n  movableArea.injectScript(webView)\n  movableArea.setupHandler(browserWindow)\n\n  if (options.show !== false) {\n    browserWindow.show()\n  }\n\n  browserWindow.on('closed', function() {\n    browserWindow._destroyed = true\n    threadDictionary.removeObjectForKey(identifier)\n    var observer = threadDictionary[identifier + '.themeObserver']\n    if (observer) {\n      NSApplication.sharedApplication().removeObserver_forKeyPath(\n        observer,\n        'effectiveAppearance'\n      )\n      threadDictionary.removeObjectForKey(identifier + '.themeObserver')\n    }\n    fiber.cleanup()\n  })\n\n  threadDictionary[identifier] = panel\n\n  fiber.onCleanup(function() {\n    if (!browserWindow._destroyed) {\n      browserWindow.destroy()\n    }\n  })\n\n  return browserWindow\n}\n\nBrowserWindow.fromId = function(identifier) {\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  if (threadDictionary[identifier]) {\n    return BrowserWindow.fromPanel(threadDictionary[identifier], identifier)\n  }\n\n  return undefined\n}\n\nBrowserWindow.fromPanel = function(panel, identifier) {\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (!panel || !panel.contentView) {\n    throw new Error('needs to pass an NSPanel')\n  }\n\n  var webView = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webView &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webView = subviews[i]\n    }\n  }\n\n  if (!webView) {\n    throw new Error('The panel needs to have a webview')\n  }\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n\n  return browserWindow\n}\n\nmodule.exports = BrowserWindow\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webView) {\n  var source =\n    'window.originalPostMessage = window.postMessage;' +\n    'window.postMessage = function(actionName) {' +\n    '  if (!actionName) {' +\n    \"    throw new Error('missing action name')\" +\n    '  }' +\n    '  var id = String(Math.random()).replace(\".\", \"\");' +\n    '    var args = [].slice.call(arguments);' +\n    '    args.unshift(id);' +\n    '  return new Promise(function (resolve, reject) {' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n    '\" + id] = resolve;' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n    '\" + id] = reject;' +\n    '    window.webkit.messageHandlers.' +\n    CONSTANTS.JS_BRIDGE +\n    '.postMessage(JSON.stringify(args));' +\n    '  });' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    '(function () {' +\n    \"document.addEventListener('mousedown', onMouseDown);\" +\n    '' +\n    'function shouldDrag(target) {' +\n    '  if (!target || (target.dataset || {}).appRegion === \"no-drag\") { return false }' +\n    '  if ((target.dataset || {}).appRegion === \"drag\") { return true }' +\n    '  return shouldDrag(target.parentElement)' +\n    '};' +\n    '' +\n    'function onMouseDown(e) {' +\n    '  if (e.button !== 0 || !shouldDrag(e.target)) { return }' +\n    '  window.postMessage(\"' +\n    CONSTANTS.START_MOVING_WINDOW +\n    '\");' +\n    '};' +\n    '})()'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n\nmodule.exports.setupHandler = function(browserWindow) {\n  var initialMouseLocation = null\n  var initialWindowPosition = null\n  var interval = null\n\n  function moveWindow() {\n    // if the user released the button, stop moving the window\n    if (!initialWindowPosition || NSEvent.pressedMouseButtons() !== 1) {\n      clearInterval(interval)\n      initialMouseLocation = null\n      initialWindowPosition = null\n      return\n    }\n\n    var mouse = NSEvent.mouseLocation()\n    browserWindow.setPosition(\n      initialWindowPosition.x + (mouse.x - initialMouseLocation.x),\n      initialWindowPosition.y + (initialMouseLocation.y - mouse.y), // y is inverted\n      false\n    )\n  }\n\n  browserWindow.webContents.on(CONSTANTS.START_MOVING_WINDOW, function() {\n    initialMouseLocation = NSEvent.mouseLocation()\n    var position = browserWindow.getPosition()\n    initialWindowPosition = {\n      x: position[0],\n      y: position[1],\n    }\n\n    interval = setInterval(moveWindow, 1000 / 60) // 60 fps\n  })\n}\n","module.exports = function(webArguments) {\n  var args = null\n  try {\n    args = JSON.parse(webArguments)\n  } catch (e) {\n    // malformed arguments\n  }\n\n  if (\n    !args ||\n    !args.constructor ||\n    args.constructor !== Array ||\n    args.length == 0\n  ) {\n    return null\n  }\n\n  return args\n}\n","var ObjCClass = require('mocha-js-delegate')\nvar parseWebArguments = require('./parseWebArguments')\nvar CONSTANTS = require('./constants')\n\n// We create one ObjC class for ourselves here\nvar WindowDelegateClass\nvar NavigationDelegateClass\nvar WebScriptHandlerClass\nvar ThemeObserverClass\n\n// TODO: events\n// - 'page-favicon-updated'\n// - 'new-window'\n// - 'did-navigate-in-page'\n// - 'will-prevent-unload'\n// - 'crashed'\n// - 'unresponsive'\n// - 'responsive'\n// - 'destroyed'\n// - 'before-input-event'\n// - 'certificate-error'\n// - 'found-in-page'\n// - 'media-started-playing'\n// - 'media-paused'\n// - 'did-change-theme-color'\n// - 'update-target-url'\n// - 'cursor-changed'\n// - 'context-menu'\n// - 'select-bluetooth-device'\n// - 'paint'\n// - 'console-message'\n\nmodule.exports = function(browserWindow, panel, webview, options) {\n  if (!ThemeObserverClass) {\n    ThemeObserverClass = new ObjCClass({\n      utils: null,\n\n      'observeValueForKeyPath:ofObject:change:context:': function() {\n        this.utils.executeJavaScript(\n          \"document.body.classList.remove('__skpm-\" +\n            (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n              ? 'light'\n              : 'dark') +\n            \"'); document.body.classList.add('__skpm-\" +\n            (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n              ? 'dark'\n              : 'light') +\n            \"')\"\n        )\n      },\n    })\n  }\n\n  if (!WindowDelegateClass) {\n    WindowDelegateClass = new ObjCClass({\n      utils: null,\n      panel: null,\n\n      'windowDidResize:': function() {\n        this.utils.emit('resize')\n      },\n\n      'windowDidMiniaturize:': function() {\n        this.utils.emit('minimize')\n      },\n\n      'windowDidDeminiaturize:': function() {\n        this.utils.emit('restore')\n      },\n\n      'windowDidEnterFullScreen:': function() {\n        this.utils.emit('enter-full-screen')\n      },\n\n      'windowDidExitFullScreen:': function() {\n        this.utils.emit('leave-full-screen')\n      },\n\n      'windowDidMove:': function() {\n        this.utils.emit('move')\n        this.utils.emit('moved')\n      },\n\n      'windowShouldClose:': function() {\n        var shouldClose = 1\n        this.utils.emit('close', {\n          get defaultPrevented() {\n            return !shouldClose\n          },\n          preventDefault: function() {\n            shouldClose = 0\n          },\n        })\n        return shouldClose\n      },\n\n      'windowWillClose:': function() {\n        this.utils.emit('closed')\n      },\n\n      'windowDidBecomeKey:': function() {\n        this.utils.emit('focus', this.panel.currentEvent())\n      },\n\n      'windowDidResignKey:': function() {\n        this.utils.emit('blur')\n      },\n    })\n  }\n\n  if (!NavigationDelegateClass) {\n    NavigationDelegateClass = new ObjCClass({\n      state: {\n        wasReady: 0,\n      },\n      utils: null,\n\n      // // Called when the web view begins to receive web content.\n      'webView:didCommitNavigation:': function(webView) {\n        this.utils.emit('will-navigate', {}, String(String(webView.URL())))\n      },\n\n      // // Called when web content begins to load in a web view.\n      'webView:didStartProvisionalNavigation:': function() {\n        this.utils.emit('did-start-navigation')\n        this.utils.emit('did-start-loading')\n      },\n\n      // Called when a web view receives a server redirect.\n      'webView:didReceiveServerRedirectForProvisionalNavigation:': function() {\n        this.utils.emit('did-get-redirect-request')\n      },\n\n      // // Called when the web view needs to respond to an authentication challenge.\n      // 'webView:didReceiveAuthenticationChallenge:completionHandler:': function(\n      //   webView,\n      //   challenge,\n      //   completionHandler\n      // ) {\n      //   function callback(username, password) {\n      //     completionHandler(\n      //       0,\n      //       NSURLCredential.credentialWithUser_password_persistence(\n      //         username,\n      //         password,\n      //         1\n      //       )\n      //     )\n      //   }\n      //   var protectionSpace = challenge.protectionSpace()\n      //   this.utils.emit(\n      //     'login',\n      //     {},\n      //     {\n      //       method: String(protectionSpace.authenticationMethod()),\n      //       url: 'not implemented', // TODO:\n      //       referrer: 'not implemented', // TODO:\n      //     },\n      //     {\n      //       isProxy: !!protectionSpace.isProxy(),\n      //       scheme: String(protectionSpace.protocol()),\n      //       host: String(protectionSpace.host()),\n      //       port: Number(protectionSpace.port()),\n      //       realm: String(protectionSpace.realm()),\n      //     },\n      //     callback\n      //   )\n      // },\n\n      // Called when an error occurs during navigation.\n      // 'webView:didFailNavigation:withError:': function(\n      //   webView,\n      //   navigation,\n      //   error\n      // ) {},\n\n      // Called when an error occurs while the web view is loading content.\n      'webView:didFailProvisionalNavigation:withError:': function(\n        webView,\n        navigation,\n        error\n      ) {\n        this.utils.emit('did-fail-load', error)\n      },\n\n      // Called when the navigation is complete.\n      'webView:didFinishNavigation:': function() {\n        if (this.state.wasReady == 0) {\n          this.state.wasReady = 1\n          this.utils.emitBrowserEvent('ready-to-show')\n        }\n        this.utils.emit('did-navigate')\n        this.utils.emit('did-frame-navigate')\n        this.utils.emit('did-stop-loading')\n        this.utils.emit('did-finish-load')\n        this.utils.emit('did-frame-finish-load')\n      },\n\n      // Called when the web view’s web content process is terminated.\n      'webViewWebContentProcessDidTerminate:': function() {\n        this.utils.emit('dom-ready')\n      },\n\n      // Decides whether to allow or cancel a navigation.\n      // webView:decidePolicyForNavigationAction:decisionHandler:\n\n      // Decides whether to allow or cancel a navigation after its response is known.\n      // webView:decidePolicyForNavigationResponse:decisionHandler:\n    })\n  }\n\n  if (!WebScriptHandlerClass) {\n    WebScriptHandlerClass = new ObjCClass({\n      utils: null,\n      'userContentController:didReceiveScriptMessage:': function(_, message) {\n        var args = this.utils.parseWebArguments(String(message.body()))\n        if (!args) {\n          return\n        }\n        if (!args[0] || typeof args[0] !== 'string') {\n          return\n        }\n        args[0] = String(args[0])\n\n        this.utils.emit.apply(this, args)\n      },\n    })\n  }\n\n  var themeObserver = ThemeObserverClass.new({\n    utils: {\n      executeJavaScript(script) {\n        webview.evaluateJavaScript_completionHandler(script, null)\n      },\n    },\n  })\n\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    \"document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-\" +\n      (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n        ? 'dark'\n        : 'light') +\n      \"') }, false)\",\n    0,\n    true\n  )\n  webview\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n\n  NSApplication.sharedApplication().addObserver_forKeyPath_options_context(\n    themeObserver,\n    'effectiveAppearance',\n    NSKeyValueChangeNewKey,\n    null\n  )\n\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n  threadDictionary[browserWindow.id + '.themeObserver'] = themeObserver\n\n  var navigationDelegate = NavigationDelegateClass.new({\n    utils: {\n      setTitle: browserWindow.setTitle.bind(browserWindow),\n      emitBrowserEvent() {\n        try {\n          browserWindow.emit.apply(browserWindow, arguments)\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n      emit() {\n        try {\n          browserWindow.webContents.emit.apply(\n            browserWindow.webContents,\n            arguments\n          )\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n    },\n    state: {\n      wasReady: 0,\n    },\n  })\n\n  webview.setNavigationDelegate(navigationDelegate)\n\n  var webScriptHandler = WebScriptHandlerClass.new({\n    utils: {\n      emit(id, type) {\n        if (!type) {\n          webview.evaluateJavaScript_completionHandler(\n            CONSTANTS.JS_BRIDGE_RESULT_SUCCESS + id + '()',\n            null\n          )\n          return\n        }\n\n        var args = []\n        for (var i = 2; i < arguments.length; i += 1) args.push(arguments[i])\n\n        var listeners = browserWindow.webContents.listeners(type)\n\n        Promise.all(\n          listeners.map(function(l) {\n            return Promise.resolve().then(function() {\n              return l.apply(l, args)\n            })\n          })\n        )\n          .then(function(res) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n                id +\n                '(' +\n                JSON.stringify(res) +\n                ')',\n              null\n            )\n          })\n          .catch(function(err) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n                id +\n                '(' +\n                JSON.stringify(err) +\n                ')',\n              null\n            )\n          })\n      },\n      parseWebArguments: parseWebArguments,\n    },\n  })\n\n  webview\n    .configuration()\n    .userContentController()\n    .addScriptMessageHandler_name(webScriptHandler, CONSTANTS.JS_BRIDGE)\n\n  var utils = {\n    emit() {\n      try {\n        browserWindow.emit.apply(browserWindow, arguments)\n      } catch (err) {\n        if (\n          typeof process !== 'undefined' &&\n          process.listenerCount &&\n          process.listenerCount('uncaughtException')\n        ) {\n          process.emit('uncaughtException', err, 'uncaughtException')\n        } else {\n          console.error(err)\n          throw err\n        }\n      }\n    },\n  }\n  if (options.modal) {\n    // find the window of the document\n    var msdocument\n    if (options.parent.type === 'Document') {\n      msdocument = options.parent.sketchObject\n    } else {\n      msdocument = options.parent\n    }\n    if (msdocument && String(msdocument.class()) === 'MSDocumentData') {\n      // we only have an MSDocumentData instead of a MSDocument\n      // let's try to get back to the MSDocument\n      msdocument = msdocument.delegate()\n    }\n    utils.parentWindow = msdocument.windowForSheet()\n  }\n\n  var windowDelegate = WindowDelegateClass.new({\n    utils: utils,\n    panel: panel,\n  })\n\n  panel.setDelegate(windowDelegate)\n}\n","var EventEmitter = require('events')\nvar executeJavaScript = require('./execute-javascript')\n\n// let's try to match https://github.com/electron/electron/blob/master/docs/api/web-contents.md\nmodule.exports = function buildAPI(browserWindow, panel, webview) {\n  var webContents = new EventEmitter()\n\n  webContents.loadURL = browserWindow.loadURL\n\n  webContents.loadFile = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.downloadURL = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.getURL = function() {\n    return String(webview.url())\n  }\n\n  webContents.getTitle = function() {\n    return String(webview.title())\n  }\n\n  webContents.isDestroyed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.focus = browserWindow.focus\n  webContents.isFocused = browserWindow.isFocused\n\n  webContents.isLoading = function() {\n    return !!webview.loading()\n  }\n\n  webContents.isLoadingMainFrame = function() {\n    // TODO:\n    return !!webview.loading()\n  }\n\n  webContents.isWaitingForResponse = function() {\n    return !webview.loading()\n  }\n\n  webContents.stop = function() {\n    webview.stopLoading()\n  }\n  webContents.reload = function() {\n    webview.reload()\n  }\n  webContents.reloadIgnoringCache = function() {\n    webview.reloadFromOrigin()\n  }\n  webContents.canGoBack = function() {\n    return !!webview.canGoBack()\n  }\n  webContents.canGoForward = function() {\n    return !!webview.canGoForward()\n  }\n  webContents.canGoToOffset = function(offset) {\n    return !!webview.backForwardList().itemAtIndex(offset)\n  }\n  webContents.clearHistory = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.goBack = function() {\n    webview.goBack()\n  }\n  webContents.goForward = function() {\n    webview.goForward()\n  }\n  webContents.goToIndex = function(index) {\n    var backForwardList = webview.backForwardList()\n    var backList = backForwardList.backList()\n    var backListLength = backList.count()\n    if (backListLength > index) {\n      webview.loadRequest(NSURLRequest.requestWithURL(backList[index]))\n      return\n    }\n    var forwardList = backForwardList.forwardList()\n    if (forwardList.count() > index - backListLength) {\n      webview.loadRequest(\n        NSURLRequest.requestWithURL(forwardList[index - backListLength])\n      )\n      return\n    }\n    throw new Error('Cannot go to index ' + index)\n  }\n  webContents.goToOffset = function(offset) {\n    if (!webContents.canGoToOffset(offset)) {\n      throw new Error('Cannot go to offset ' + offset)\n    }\n    webview.loadRequest(\n      NSURLRequest.requestWithURL(webview.backForwardList().itemAtIndex(offset))\n    )\n  }\n  webContents.isCrashed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setUserAgent = function(/* userAgent */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.getUserAgent = function() {\n    const userAgent = webview.customUserAgent()\n    return userAgent ? String(userAgent) : undefined\n  }\n  webContents.insertCSS = function(css) {\n    var source =\n      \"var style = document.createElement('style'); style.innerHTML = \" +\n      css.replace(/\"/, '\\\\\"') +\n      '; document.head.appendChild(style);'\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.insertJS = function(source) {\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.executeJavaScript = executeJavaScript(webview, browserWindow)\n  webContents.setIgnoreMenuShortcuts = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setAudioMuted = function(/* muted */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.isAudioMuted = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setZoomFactor = function(factor) {\n    webview.setMagnification_centeredAtPoint(factor, CGPointMake(0, 0))\n  }\n  webContents.getZoomFactor = function(callback) {\n    callback(Number(webview.magnification()))\n  }\n  webContents.setZoomLevel = function(level) {\n    // eslint-disable-next-line no-restricted-properties\n    webContents.setZoomFactor(Math.pow(1.2, level))\n  }\n  webContents.getZoomLevel = function(callback) {\n    // eslint-disable-next-line no-restricted-properties\n    callback(Math.log(Number(webview.magnification())) / Math.log(1.2))\n  }\n  webContents.setVisualZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setLayoutZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  // TODO:\n  // webContents.undo = function() {\n  //   webview.undoManager().undo()\n  // }\n  // webContents.redo = function() {\n  //   webview.undoManager().redo()\n  // }\n  // webContents.cut = webview.cut\n  // webContents.copy = webview.copy\n  // webContents.paste = webview.paste\n  // webContents.pasteAndMatchStyle = webview.pasteAsRichText\n  // webContents.delete = webview.delete\n  // webContents.replace = webview.replaceSelectionWithText\n\n  webContents.send = function() {\n    const script =\n      'window.postMessage({' +\n      'isSketchMessage: true,' +\n      \"origin: '\" +\n      String(__command.identifier()) +\n      \"',\" +\n      'args: ' +\n      JSON.stringify([].slice.call(arguments)) +\n      '}, \"*\")'\n    webview.evaluateJavaScript_completionHandler(script, null)\n  }\n\n  webContents.getNativeWebview = function() {\n    return webview\n  }\n\n  browserWindow.webContents = webContents\n}\n","/* globals NSThread */\nvar threadDictionary = NSThread.mainThread().threadDictionary()\n\nmodule.exports.getWebview = function(identifier) {\n  return require('./lib').fromId(identifier) // eslint-disable-line\n}\n\nmodule.exports.isWebviewPresent = function isWebviewPresent(identifier) {\n  return !!threadDictionary[identifier]\n}\n\nmodule.exports.sendToWebview = function sendToWebview(identifier, evalString) {\n  if (!module.exports.isWebviewPresent(identifier)) {\n    return\n  }\n\n  var panel = threadDictionary[identifier]\n  var webview = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webview &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webview = subviews[i]\n    }\n  }\n\n  if (!webview || !webview.evaluateJavaScript_completionHandler) {\n    throw new Error('Webview ' + identifier + ' not found')\n  }\n\n  webview.evaluateJavaScript_completionHandler(evalString, null)\n}\n","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\n\nconst webviewIdentifier = 'chart2.templates.webview'\n\n// TODO: This is most likely not a view\nexport default function () {\n  const options = {\n    identifier: webviewIdentifier,\n    width: 496,\n    height: 400,\n    show: false,\n  }\n\n  const browserWindow = new BrowserWindow(options)\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  browserWindow.loadURL(require('./view/templates.html'))\n}\n\nexport function onShutdown() {\n  const existingWebview = getWebview(webviewIdentifier)\n  if (existingWebview) {\n    existingWebview.close()\n  }\n}\n","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/fc140bdcf317530516d879837cea2f5f.html\";"],"sourceRoot":""}